# Курсовая работа по курсу Теории Решёток. 
## Задание https://github.com/fdrstrok/lazyfca15/blob/master/old_description.pdf

Для задания по Lazy FCA использовалcя датасет SPECT, содержащий данные по позитронной томографии сердца (22 бинарных признака, отвечающие поддиагнозам, целевой признак также бинарный).

## Краткое описание осбенностей датасета:
*	дисбаланс классов при малом числе наблюдений (всего 267 примеров, из них только 55 отрицательные)
* рекомендованные обучающая выборка содерит по 40 примеров положительных и отрицательных данных, а рекомендованная тестовая выборка только 17 отрицательных примеров.
* практически любое «правило», полученное пересечением признаков тестового объекта и объектов и обучающей выборки, находит контрпример

## Описание решения:
Для отнесения объекта к положительному или отрицательному классу использовалась агрегационная функция на основе достоверности  ![equation](http://www.sciweavers.org/upload/Tex2Img_1544007232/render.png), уже реализованная в скрипте из исходного репоозитория `test_generators.py`
Для подбора оптимальных пороговых значений исходные тестовая и обучающая выборки были объединены, переразбиты на 7 фолдов для кросс-валидации. Оптимальные значения порогов подбирались прямым перебором так, чтобы на всех 267 примерах значения меры  были максимальными, и составили  0.23 для отрицательного и  0.062 для положительного контекстов. Таким образом для классификации объекта как положительного нужно, чтобы мера достоверности отнесения к отрицательному контексту была менее 0.23 или мера достоверности отнесения к положительному более 0.062. Код, реализующий перебор и проверку, приложен (spect_generators.py)

## Результаты
На официальных трейне и тесте подхд, в отличие от «наивной» гипотезы (все объекты положительные), опознаёт часть отрицательных результатов. Подход также работает корректно, если поменять несбалансированный train и сбалансированный test местами.

![res](https://pp.userapi.com/c849232/v849232538/d3784/V-8PFuCUQjc.jpg)
